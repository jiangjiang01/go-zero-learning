# ============================== 用户 API 服务 配置文件 ==============================
# 该配置文件用于 user-api 服务的全局参数、连接配置、日志、上传、RPC 客户端等设置
# 每一项配置均包含详细注释说明实际用途、功能及推荐用法

# --------------------------------------------------------------------
# 服务名称，用于服务内部识别和日志记录，此名称必须与编排服务名一致
Name: user-api

# HTTP 监听地址，0.0.0.0 表示监听所有网卡（容器内部通常设置为 0.0.0.0 以便外部访问）
Host: 0.0.0.0

# HTTP 服务监听端口，此端口需与 docker compose 映射端口保持一致
Port: 8888

# --------------------------------------------------------------------
# 单次 HTTP 请求最大 Body 大小限制，单位为字节（这里为 10MB，适用于支持大文件上传场景）
# 如上传图片、音频等若需更大可酌情调整
MaxBytes: 10485760 # 10MB

# --------------------------------------------------------------------
# MySQL 数据库连接配置（DataSource）
# - root:${MYSQL_ROOT_PASSWORD}   -> 数据库用户名和密码
# - ${MYSQL_HOST}:3306    -> 服务名及数据库端口（通过 docker 内部网络访问）
# - ${MYSQL_DATABASE}        -> 数据库名
# - charset=utf8mb4           -> 字符集（支持 Emoji）
# - parseTime=True            -> 启用时间类型自动解析
# - loc=Local                 -> 设置时区为本地
# ⚠️ 建议生产环境修改为强密码和正式数据库
DataSource: root:${MYSQL_ROOT_PASSWORD}@tcp(${MYSQL_HOST}:3306)/${MYSQL_DATABASE}?charset=utf8mb4&parseTime=True&loc=Local

# --------------------------------------------------------------------
# JWT 配置项，用于用户身份验证等场景下生成与校验令牌（Token）
JWT:
  Secret: "${JWT_SECRET}"    # JWT 密钥，务必在生产环境替换为安全复杂的随机字符串！
  ExpireDays: 7                    # Token 过期天数（此示例为 7 天，调整可延长/缩短登录态）

# --------------------------------------------------------------------
# Redis 缓存配置（高性能 KV 存储，支持多种业务缓存和分布式场景）
Redis:
  Host: "${REDIS_HOST}"   # Redis 服务地址，直接填写 docker compose 网络中的服务名
  Type: "node"         # 单节点模式（如集群部署请改用 cluster 并提供对应节点信息）
  Pass: ""             # Redis 访问密码，默认为空，生产环境建议设置密码
  Tls: false           # 是否启用 TLS 加密，若 Redis 开启了加密需要设为 true

# --------------------------------------------------------------------
# 日志相关配置，建议在生产环境中采用 file 或 volume 模式进行日志长期保存与分析
Log:
  ServiceName: user-api        # 当前服务日志标识，可据此筛选分析日志
  Mode: file                   # 日志存储方式：console(控制台输出)、file(文件写盘)、volume(挂载日志卷到宿主机)
  Path: logs                   # 日志文件存储目录，相对于应用启动工作目录
  Level: info                  # 最低写入日志级别：debug(调试)、info(信息)、error(错误)、severe(严重)
  Compress: true               # 是否对历史日志进行压缩归档
  KeepDays: 7                  # 日志保留天数，到期自动清理，减轻磁盘压力
  StackCooldownMillis: 100     # 堆栈追踪冷却期，防止同类错误频繁刷屏，单位：毫秒

# --------------------------------------------------------------------
# 文件上传相关配置
Upload:
  Path: uploads                # 上传文件存储目录（相对路径，容器挂载至数据卷实现持久存储）
  MaxSize: 10485760            # 单文件最大允许上传大小（10MB，单位字节）
  AllowedTypes:                # 允许上传文件的 MIME 类型白名单
    - image/jpeg
    - image/png
    - image/gif
    - image/webp
  BaseURL: http://localhost:8888/static # 静态资源访问地址，供前端等服务访问已上传的文件

# --------------------------------------------------------------------
# 用户 RPC 微服务客户端调用配置（user-rpc），通过 Docker 服务名通信
UserRpc:
  Endpoints:
    - user-rpc:8081           # user-rpc RPC 服务的主机与端口（通过 docker compose 内部解析）
  Timeout: 3000               # RPC 请求超时时间（单位：毫秒）

# --------------------------------------------------------------------
# 商品 RPC 微服务客户端调用配置（product-rpc）
ProductRpc:
  Endpoints:
    - product-rpc:8082        # product-rpc RPC 服务主机与端口
  Timeout: 3000               # RPC 请求超时时间（毫秒）
# ============================ 配置文件结束 ===========================
